var PointerLockControls=function(e,t){var n=2;var r=.2;var i=20;var s=this;var o=new THREE.Object3D;o.add(e);var u=new THREE.Object3D;u.position.y=2;u.add(o);var a=new THREE.Quaternion;var f=false;var l=false;var c=false;var h=false;var p=false;var d=new CANNON.Vec3;var v=new CANNON.Vec3(0,1,0);t.addEventListener("collide",function(e){var n=e.contact;if(n.bi.id==t.id)n.ni.negate(d);else d.copy(n.ni);if(d.dot(v)>.5)p=true});var m=t.velocity;var g=Math.PI/2;var y=function(e){if(s.enabled===false)return;var t=e.movementX||e.mozMovementX||0;var n=e.movementY||e.mozMovementY||0;u.rotation.y-=t*.002;o.rotation.x-=n*.002;o.rotation.x=Math.max(-g,Math.min(g,o.rotation.x))};var b=function(e){switch(e.keyCode){case 38:case 87:f=true;break;case 37:case 65:c=true;break;case 40:case 83:l=true;break;case 39:case 68:h=true;break;case 32:if(p===true){m.y=i}p=false;break}};var w=function(e){switch(e.keyCode){case 38:case 87:f=false;break;case 37:case 65:c=false;break;case 40:case 83:l=false;break;case 39:case 68:h=false;break}};document.addEventListener("mousemove",y,false);document.addEventListener("keydown",b,false);document.addEventListener("keyup",w,false);this.enabled=false;this.getObject=function(){return u};this.getDirection=function(e){e.set(0,0,-1);a.multiplyVector3(e)};var E=new THREE.Vector3;var S=new THREE.Euler;this.update=function(e){if(s.enabled===false)return;e*=.1;E.set(0,0,0);if(f){E.z=-r*e}if(l){E.z=r*e}if(c){E.x=-r*e}if(h){E.x=r*e}S.x=o.rotation.x;S.y=u.rotation.y;S.order="XYZ";a.setFromEuler(S);E.applyQuaternion(a);m.x+=E.x;m.z+=E.z;u.position.copy(t.position)}}