var PointerLockControls=function(e,t){var n=.2,o=20,a=this,i=new THREE.Object3D;i.add(e);var c=new THREE.Object3D;c.position.y=2,c.add(i);var s=new THREE.Quaternion,r=!1,d=!1,m=!1,u=!1,v=!1;t.addEventListener("collide",function(){v=!0});var b=t.velocity,k=Math.PI/2,y=function(e){if(a.enabled!==!1){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,n=e.movementY||e.mozMovementY||e.webkitMovementY||0;c.rotation.y-=.002*t,i.rotation.x-=.002*n,i.rotation.x=Math.max(-k,Math.min(k,i.rotation.x))}},E=function(e){switch(e.keyCode){case 38:case 87:r=!0;break;case 37:case 65:m=!0;break;case 40:case 83:d=!0;break;case 39:case 68:u=!0;break;case 32:v===!0&&(b.y=o),v=!1}},l=function(e){switch(e.keyCode){case 38:case 87:r=!1;break;case 37:case 65:m=!1;break;case 40:case 83:d=!1;break;case 39:case 68:u=!1}};document.addEventListener("mousemove",y,!1),document.addEventListener("keydown",E,!1),document.addEventListener("keyup",l,!1),this.enabled=!1,this.getObject=function(){return c},this.getDirection=function(e){e.set(0,0,-1),s.multiplyVector3(e)};var h=new THREE.Vector3;this.update=function(e){a.enabled!==!1&&(e*=.1,h.set(0,0,0),r&&(h.z=-n*e),d&&(h.z=n*e),m&&(h.x=-n*e),u&&(h.x=n*e),s.setFromEuler({x:i.rotation.x,y:c.rotation.y,z:0},"XYZ"),s.multiplyVector3(h),b.x+=h.x,b.z+=h.z,t.position.copy(c.position))}};